<!-- Only return the amount selection section for HTMX updates -->
<div class="donation-amounts" id="amount-selection">
   <h4>Select Amount</h4>
    <div class="amount-grid">
  <% if (!presetAmounts) { presetAmounts = ["25", "50", "100", "250", "500", "1000"] } %>
      <% for (preset) in presetAmounts { %>
        <% btnClass = "outline amount-btn" %>
        <% if (amount == preset) { btnClass = fmt.Sprintf("%s active", btnClass) } %>
        <% hxVals = fmt.Sprintf("{\"amount\":\"%s\",\"source\":\"preset\"}", preset) %>
        <button type="button" 
                class="<%= btnClass %>" 
                hx-post="/donate/update_amount"
                hx-vals='<%= hxVals %>'
                hx-include="closest form"
                hx-target="#amount-selection"
                hx-swap="outerHTML">$<%= preset %></button>
      <% } %>
    </div>
    
    <div class="custom-amount-group" style="margin-top:1em;">
      <label for="amount">Or enter a custom amount</label>
      <input type="number" 
             id="amount" 
             name="amount" 
             autocomplete="transaction-amount" 
             placeholder="Enter custom amount" 
             step="any" 
             hx-post="/donate/update_amount"
             hx-trigger="input changed delay:500ms"
             hx-include="closest form"
             hx-target="#amount-selection"
             hx-swap="outerHTML"
             value="<%= amount %>">
    </div>
    
    <style>
    <%# Active state for amount buttons %>
    .amount-btn.active {
      background-color: var(--pico-primary) !important;
      border-color: var(--pico-primary) !important;
      color: var(--pico-primary-inverse) !important;
    }
    
    <%# Ensure outline buttons have proper hover/focus states %>
    .amount-btn.outline:hover:not(.active) {
      background-color: var(--pico-primary-hover);
      border-color: var(--pico-primary-hover);
      color: var(--pico-primary-inverse);
    }
    
    <%# Active state for custom amount input %>
    .active-custom {
      border-color: var(--pico-primary) !important;
      box-shadow: 0 0 0 2px var(--pico-primary-focus) !important;
    }
    </style>
</div>

<!-- Button text update section -->
<div id="donation-button-container">
  <button role="button" class="contrast donation-submit">
    <%# Button text is computed in parent template; fall back if missing %>
    <% if (!buttonText) { %>
      <% buttonText = "" %>
      <% if (amount != "") { %>
        <% if (donationType == "monthly") { %>
          <% buttonText = fmt.Sprintf("Donate $%s Monthly", amount) %>
        <% } else { %>
          <% buttonText = fmt.Sprintf("Donate $%s Now", amount) %>
        <% } %>
      <% } else { %>
        <% if (donationType == "monthly") { %>
          <% buttonText = "Donate Monthly" %>
        <% } else { %>
          <% buttonText = "Donate Now" %>
        <% } %>
      <% } %>
    <% } %>
    <%= buttonText %>
  </button>
</div>
