<!-- Edit User (HTMX Partial) -->
<header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
  <div>
    <h1>Edit User</h1>
    <p>Editing: <strong><%= user.FirstName %> <%= user.LastName %></strong></p>
  </div>
  <div>
    <a href="/admin/users/<%= user.ID %>" role="button" class="outline"
       hx-get="/admin/users/<%= user.ID %>" hx-target="#main-content" hx-push-url="true">‚Üê Back to User</a>
  </div>
</header>

<%= if (errors) { %>
<article style="background-color: var(--pico-form-element-invalid-border-color); color: white; margin-bottom: 2rem;">
  <header><strong>Validation Errors</strong></header>
  <ul style="margin: 0;">
    <%= for (key, messages) in errors { %>
      <%= for (message) in messages { %>
      <li><%= message %></li>
      <% } %>
    <% } %>
  </ul>
</article>
<% } %>

<form action="/admin/users/<%= user.ID %>" method="POST" 
      hx-put="/admin/users/<%= user.ID %>" hx-target="#main-content" hx-swap="innerHTML">
  <input type="hidden" name="authenticity_token" value="<%= authenticity_token %>">

  <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem;">
    <!-- User Information -->
    <section>
      <h3>User Information</h3>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
        <div>
          <label for="user-first-name">First Name *</label>
          <input type="text" id="user-first-name" name="FirstName" value="<%= user.FirstName %>" required>
        </div>
        <div>
          <label for="user-last-name">Last Name *</label>
          <input type="text" id="user-last-name" name="LastName" value="<%= user.LastName %>" required>
        </div>
      </div>

      <div style="margin-bottom: 1rem;">
        <label for="user-email">Email Address *</label>
        <input type="email" id="user-email" name="Email" value="<%= user.Email %>" required>
        <small>User's email address for login and communications</small>
      </div>

      <div style="margin-bottom: 1rem;">
        <label for="user-role">Account Role *</label>
        <select id="user-role" name="Role" required>
          <%= for (option) in roleOptions { %>
            <option value="<%= option["value"] %>" <%= if (user.Role == option["value"]) { %>selected<% } %>>
              <%= option["label"] %>
            </option>
          <% } %>
        </select>
        <small>
          <strong>User:</strong> Standard account with basic access<br>
          <strong>Administrator:</strong> Full access to admin panel and user management
        </small>
      </div>
    </section>

    <!-- Account Details -->
    <aside style="background-color: var(--pico-card-background-color); padding: 1.5rem; border-radius: var(--pico-border-radius); height: fit-content;">
      <h3 style="margin-top: 0;">Account Status</h3>
      
      <div style="margin-bottom: 1rem;">
        <strong>User ID:</strong><br>
        <code><%= user.ID %></code>
      </div>

      <div style="margin-bottom: 1rem;">
        <strong>Created:</strong><br>
        <%= dateFormat(user.CreatedAt, "Jan 2, 2006 at 3:04 PM") %>
      </div>

      <div style="margin-bottom: 1rem;">
        <strong>Last Updated:</strong><br>
        <%= dateFormat(user.UpdatedAt, "Jan 2, 2006 at 3:04 PM") %>
      </div>

      <hr>
      <small style="color: var(--pico-muted-color);">
        <strong>Note:</strong> Password changes must be done by the user through their account settings.
      </small>
    </aside>
  </div>

  <!-- Form Actions -->
  <section style="border-top: 1px solid var(--pico-muted-border-color); padding-top: 2rem;">
    <div style="display: flex; gap: 1rem; justify-content: flex-end;">
      <a href="/admin/users/<%= user.ID %>" role="button" class="secondary"
         hx-get="/admin/users/<%= user.ID %>" hx-target="#main-content" hx-push-url="true">
        Cancel
      </a>
      <button type="submit" class="primary">Update User</button>
    </div>
  </section>
</form>
