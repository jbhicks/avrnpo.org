<!-- Admin Users Management (HTMX Partial) -->
<header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
  <div>
    <h1>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
        <circle cx="9" cy="7" r="4"/>
        <path d="m22 21-3-3 3-3"/>
      </svg>
      User Management
    </h1>
    <p>Manage user accounts, roles, and permissions</p>
  </div>
  <div>
    <a href="/admin/users/new" role="button" class="primary" 
       hx-get="/admin/users/new" hx-target="#main-content" hx-push-url="true">
      + Add New User
    </a>
  </div>
</header>

<%= if (len(users) > 0) { %>
  <article>
    <header>
      <h3>
        <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 0.5rem;">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        All Users (<%= len(users) %>)
      </h3>
    </header>
    
    <figure>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Role</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <%= for (user) in users { %>
          <tr>
            <td>
              <strong><%= user.FirstName %> <%= user.LastName %></strong>
            </td>
            <td><%= user.Email %></td>
            <td>
              <%= if (user.Role == "admin") { %>
                <span style="background-color: var(--pico-primary); color: white; padding: 0.25rem 0.5rem; border-radius: var(--pico-border-radius); font-size: 0.875rem; font-weight: bold;">Admin</span>
              <% } else { %>
                <span style="background-color: var(--pico-muted-color); color: white; padding: 0.25rem 0.5rem; border-radius: var(--pico-border-radius); font-size: 0.875rem;">User</span>
              <% } %>
            </td>
            <td><%= user.CreatedAt.Format("Jan 2, 2006") %></td>
            <td>
              <div style="display: flex; gap: 0.5rem;">
                <a href="/admin/users/<%= user.ID %>" role="button" class="outline" style="padding: 0.25rem 0.5rem; font-size: 0.875rem;"
                   hx-get="/admin/users/<%= user.ID %>" hx-target="#main-content" hx-push-url="true">View</a>
                <a href="/admin/users/<%= user.ID %>/edit" role="button" class="secondary outline" style="padding: 0.25rem 0.5rem; font-size: 0.875rem;"
                   hx-get="/admin/users/<%= user.ID %>/edit" hx-target="#main-content" hx-push-url="true">Edit</a>
                <button hx-delete="/admin/users/<%= user.ID %>" 
                        hx-confirm="Are you sure you want to delete this user? This action cannot be undone." 
                        hx-target="closest tr" hx-swap="outerHTML" 
                        role="button" class="contrast outline" 
                        style="padding: 0.25rem 0.5rem; font-size: 0.875rem;">
                  Delete
                </button>
              </div>
            </td>
          </tr>
          <% } %>
        </tbody>
      </table>
    </figure>

    <%= if (pagination && pagination.TotalPages > 1) { %>
    <footer style="display: flex; justify-content: center; margin-top: 1rem;">
      <nav aria-label="User list pagination">
        <%= if (pagination.Page > 1) { %>
          <a href="/admin/users?page=<%= pagination.Page - 1 %>" hx-get="/admin/users?page=<%= pagination.Page - 1 %>" hx-target="#main-content" hx-push-url="true">Previous</a>
        <% } %>
        
        Page <%= pagination.Page %> of <%= pagination.TotalPages %>
        
        <%= if (pagination.Page < pagination.TotalPages) { %>
          <a href="/admin/users?page=<%= pagination.Page + 1 %>" hx-get="/admin/users?page=<%= pagination.Page + 1 %>" hx-target="#main-content" hx-push-url="true">Next</a>
        <% } %>
      </nav>
    </footer>
    <% } %>
  </article>
<% } else { %>
  <article>
    <header>
      <h3>No Users Found</h3>
    </header>
    <p>No users have been created yet.</p>
    <footer>
      <a href="/admin/users/new" role="button" class="primary"
         hx-get="/admin/users/new" hx-target="#main-content" hx-push-url="true">
        Create First User
      </a>
    </footer>
  </article>
<% } %>
