<!-- Admin Users Management with Pico.css -->
<nav class="container-fluid dashboard-nav">
  <ul>
    <li>
      <a href="/" class="logo">
        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
        </svg>
        <strong>My Go SaaS</strong>
      </a>
    </li>
  </ul>
  <ul>
    <li>
      <a href="/admin">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
        Back to Admin
      </a>
    </li>
    <li>
      <!-- Compact Theme Toggle -->
      <button class="theme-toggle-btn" onclick="toggleTheme()" aria-label="Toggle theme">
        <span id="theme-icon"></span>
      </button>
    </li>
  </ul>
</nav>

<main class="container">
  <!-- Page Header -->
  <section>
    <hgroup>
      <h1>👥 User Management</h1>
      <p>Manage user accounts, roles, and permissions</p>
    </hgroup>
  </section>

  <!-- Flash Messages -->
  <%= if (flash["success"]) { %>
    <article>
      <p>✅ <%= for (msg) in flash["success"] { %><%= msg %><% } %></p>
    </article>
  <% } %>

  <%= if (flash["danger"]) { %>
    <article>
      <p>❌ <%= for (msg) in flash["danger"] { %><%= msg %><% } %></p>
    </article>
  <% } %>

  <!-- Users Table -->
  <article>
    <header>
      <h3>📋 All Users</h3>
    </header>
    
    <%= if (len(users) > 0) { %>
      <figure>
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Created</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <%= for (user) in users { %>
              <tr>
                <td>
                  <strong><%= user.FirstName %> <%= user.LastName %></strong>
                </td>
                <td><%= user.Email %></td>
                <td>
                  <%= if (user.Role == "admin") { %>
                    <span style="color: var(--pico-color-red-500);">🛡️ Admin</span>
                  <% } else { %>
                    <span>👤 User</span>
                  <% } %>
                </td>
                <td>
                  <small><%= user.CreatedAt.Format("Jan 2, 2006") %></small>
                </td>
                <td>
                  <div class="grid">
                    <a href="/admin/users/<%= user.ID %>" role="button" class="outline">Edit</a>
                    <%= if (user.ID.String() != current_user.ID.String()) { %>
                      <form method="POST" action="/admin/users/<%= user.ID %>" style="margin: 0;">
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="outline" 
                                onclick="return confirm('Are you sure you want to delete this user?')"
                                style="width: 100%;">Delete</button>
                      </form>
                    <% } %>
                  </div>
                </td>
              </tr>
            <% } %>
          </tbody>
        </table>
      </figure>

      <!-- Pagination -->
      <%= if (pagination.TotalPages > 1) { %>
        <footer>
          <nav aria-label="Users pagination">
            <%= if (pagination.Page > 1) { %>
              <a href="?page=<%= pagination.Page - 1 %>" role="button" class="outline">Previous</a>
            <% } %>
            
            <span style="margin: 0 1rem;">
              Page <%= pagination.Page %> of <%= pagination.TotalPages %>
            </span>
            
            <%= if (pagination.Page < pagination.TotalPages) { %>
              <a href="?page=<%= pagination.Page + 1 %>" role="button" class="outline">Next</a>
            <% } %>
          </nav>
        </footer>
      <% } %>
      
    <% } else { %>
      <p>No users found.</p>
    <% } %>
  </article>
</main>
